<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VSTGUI: The view system overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VSTGUI
   &#160;<span id="projectnumber">4.10</span>
   </div>
   <div id="projectbrief">Graphical User Interface Framework not only for VST plugins</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('the_view_system.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The view system overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A view is a rectangular section which is contained in a window.</p>
<p>It is responsible for handling user events and drawing to the screen. In <a class="el" href="namespace_v_s_t_g_u_i.html">VSTGUI</a> this is the CView class.</p>
<p>Another aspect of a view is that it can be part of a parent view. The main parent view is always a CFrame object. It is itself a view and it is a view container which can contain one or more child views.</p>
<p>If you need to group multiple views you can use the CViewContainer class. It is also a view but it can have child views.</p>
<h1><a class="anchor" id="inherit_from_cview"></a>
Inherit from CView</h1>
<p>If you want to draw custom data which cannot be presented via the included CView subclasses you need to create a new subclass of CView:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyView : <span class="keyword">public</span> CView</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  MyView (<span class="keyword">const</span> CRect&amp; size) : CView (size) {}</div><div class="line">};</div></div><!-- fragment --><p>If you want to draw some custom stuff, you need to override the draw method:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyView : <span class="keyword">public</span> CView</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  MyView (<span class="keyword">const</span> CRect&amp; size) : CView (size) {}</div><div class="line">  <span class="keywordtype">void</span> draw (CDrawContext* context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">  </span>{}</div><div class="line">};</div></div><!-- fragment --><p>As you see, the draw method has a CDrawContext argument. The draw context has all the methods to draw stuff into the view. Below I just show you a very simple thing, drawing a green line.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyView::draw (CDrawContext* context)<span class="keyword"> override</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  context-&gt;setFrameColor (kGreenColor);</div><div class="line">  context-&gt;drawLine (CPoint (0,0), CPoint (10, 10));</div><div class="line">}</div></div><!-- fragment --><p>Now a little strange concept of <a class="el" href="namespace_v_s_t_g_u_i.html">VSTGUI</a> is that the draw context is not automatically adjusted to the position of the view, so that if the position of the view is at x=50 and y=50, you will not see the line (because it is drawn from 0,0 to 10,10 and that is outside the views boundaries). So you need to offset your drawing by the position of the view.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyView::draw (CDrawContext* context)<span class="keyword"> override</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <span class="keyword">auto</span> viewPos = getViewSize ().getTopLeft ();</div><div class="line">  CDrawContext::Transform t (*context, CGraphicsTransform ().translate (viewPos));</div><div class="line"></div><div class="line">  context-&gt;setFrameColor (kGreenColor);</div><div class="line">  context-&gt;drawLine (CPoint (0,0), CPoint (10, 10));</div><div class="line">}</div></div><!-- fragment --><p>If CDrawContext::Transform is not defined in your <a class="el" href="namespace_v_s_t_g_u_i.html">VSTGUI</a> version you have a version older than 4.2 and you need to offset the points yourself.</p>
<p>If you have a complex view which takes a long time to draw, you can also override the CView::drawRect (CDrawContext*, const CRect&amp;) method and only draw the region which needs to be drawn.</p>
<h1><a class="anchor" id="handling_mouse_events"></a>
Handling mouse events</h1>
<p>Next you may want to add user interactions via mouse events.</p>
<p>For this you have to override two or three methods depending on if you want to track mouse movement or just want to get a mouse click. For a simple mouse click you have to do this :</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyView : <span class="keyword">public</span> CView</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <a class="code" href="namespace_v_s_t_g_u_i.html#ac49f4c9b44d5ce2870a1790690bc1092">CMouseEventResult</a> onMouseDown (CPoint&amp; where, <span class="keyword">const</span> CButtonState&amp; buttons)<span class="keyword"> override</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="namespace_v_s_t_g_u_i.html#ac49f4c9b44d5ce2870a1790690bc1092a8bb1ee91a3b1b6baa050d9634f4abcc0">kMouseEventHandled</a>; <span class="comment">// needed to get the onMouseUp call</span></div><div class="line">  }</div><div class="line">  <a class="code" href="namespace_v_s_t_g_u_i.html#ac49f4c9b44d5ce2870a1790690bc1092">CMouseEventResult</a> onMouseUp (CPoint&amp; where, <span class="keyword">const</span> CButtonState&amp; buttons)<span class="keyword"> override</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">if</span> (buttons.isLeftButton () &amp;&amp; getViewSize ().pointInside (where))</div><div class="line">      doMouseClick ();</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="namespace_v_s_t_g_u_i.html#ac49f4c9b44d5ce2870a1790690bc1092a8bb1ee91a3b1b6baa050d9634f4abcc0">kMouseEventHandled</a>;</div><div class="line">  }</div><div class="line">  <span class="keywordtype">void</span> doMouseClick () {}</div><div class="line">};</div></div><!-- fragment --><p>If a user clicks inside MyView the doMouseClick() method is called.</p>
<p>If you need to track mouse movement in your view you have to additionally override the onMouseMoved method:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyView : <span class="keyword">public</span> CView</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <a class="code" href="namespace_v_s_t_g_u_i.html#ac49f4c9b44d5ce2870a1790690bc1092">CMouseEventResult</a> onMouseMove (CPoint&amp; where, <span class="keyword">const</span> CButtonState&amp; buttons)<span class="keyword"> override</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="namespace_v_s_t_g_u_i.html#ac49f4c9b44d5ce2870a1790690bc1092a8bb1ee91a3b1b6baa050d9634f4abcc0">kMouseEventHandled</a>;</div><div class="line">  }</div><div class="line">};</div></div><!-- fragment --><p>This method is always called if the mouse moves inside your view, even if no buttons are down.</p>
<p>So if you want to track the mouse only if the left button is down you have to check for it with buttons.isLeftButton () inside that method. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="uidescription.html">Creating user interfaces</a></li>
    <li class="footer">Generated on Tue Dec 14 2021 20:02:00 for VSTGUI by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
